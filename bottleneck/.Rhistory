aes(x=n,y=theta,fill=simulation,color=simulation)) +
#geom_sina(size=0.05) +
geom_split_violin(lwd=2) +
labs(y=expression(theta[W]), color="Simulation",fill="Simulation") +
facet_grid(N~T, labeller = variable_labeller,scales="free") +
scale_color_manual(values=c("grey56", "grey0"),labels=c("coalescent","forward")) +
scale_fill_manual(values=c("grey66","grey6"),labels=c("coalescent","forward")) +
theme_classic() +
theme(text=element_text(size=65),axis.text=element_text(size=30),
axis.text.x=element_text(angle=45,margin=margin(t=40)),
axis.title.x=element_text(face = "italic"),
axis.title.y=element_text(face = "italic"),
panel.border = element_rect(linetype = "dashed", fill = NA),
strip.text = element_text(face = "italic"),
legend.key.size = unit(2.5, 'lines'),
legend.text=element_text(size=40))
png("theta-by-n-by-T1-10.png",height=2400,width=2400)
bp_1
dev.off()
variable_labeller <- function(variable,value){
return(label_parsed(variable_names[value]))
}
variable_names<- list("N" = "italic(N[e])",
"T" = "italic(T)",
"n" = "italic(n)")
bp_1<-ggplot(theta_data_factors[which(theta_data_factors$T==1 | theta_data_factors$T==10),],
aes(x=n,y=theta,fill=simulation,color=simulation)) +
#geom_sina(size=0.05) +
geom_split_violin(lwd=2) +
labs(y=expression(theta[W]), color="Simulation",fill="Simulation") +
facet_grid(N~T, labeller = variable_labeller,scales="free") +
scale_color_manual(values=c("grey56", "grey0"),labels=c("coalescent","forward")) +
scale_fill_manual(values=c("grey66","grey6"),labels=c("coalescent","forward")) +
theme_classic() +
theme(text=element_text(size=65),axis.text=element_text(size=30),
axis.text.x=element_text(angle=45,margin=margin(t=40)),
axis.title.x=element_text(face = "italic"),
axis.title.y=element_text(face = "italic"),
panel.border = element_rect(linetype = "dashed", fill = NA),
strip.text = element_text(face = "italic"),
legend.key.size = unit(2.5, 'lines'),
legend.text=element_text(size=40))
png("theta-by-n-by-T1-10.png",height=2400,width=2400)
bp_1
dev.off()
install.packages("Jmisc")
library(Jmisc)
variable_names<- colnames(theta_data_factors)
variable_names
variable_names<-c("italic(N[e]","italic(n)","italic(T)","theta","simulation","n_over_Ne")
names(variable_names)<-colnames(theta_data_factors)
variable_names
variable_names<-c("italic(N[e])","italic(n)","italic(T)","theta","simulation","n_over_Ne")
names(variable_names)<-colnames(theta_data_factors)
bp_1<-ggplot(theta_data_factors[which(theta_data_factors$T==1 | theta_data_factors$T==10),],
aes(x=n,y=theta,fill=simulation,color=simulation)) +
#geom_sina(size=0.05) +
geom_split_violin(lwd=2) +
labs(y=expression(theta[W]), color="Simulation",fill="Simulation") +
facet_grid(N~T, labeller = label_both_parsed_recode(variable_names),scales="free") +
scale_color_manual(values=c("grey56", "grey0"),labels=c("coalescent","forward")) +
scale_fill_manual(values=c("grey66","grey6"),labels=c("coalescent","forward")) +
theme_classic() +
theme(text=element_text(size=65),axis.text=element_text(size=30),
axis.text.x=element_text(angle=45,margin=margin(t=40)),
axis.title.x=element_text(face = "italic"),
axis.title.y=element_text(face = "italic"),
panel.border = element_rect(linetype = "dashed", fill = NA),
strip.text = element_text(face = "italic"),
legend.key.size = unit(2.5, 'lines'),
legend.text=element_text(size=40))
png("theta-by-n-by-T1-10.png",height=2400,width=2400)
bp_1
dev.off()
bp_100<-ggplot(theta_data_factors[which(theta_data_factors$T==100 | theta_data_factors$T==1000),],
aes(x=n,y=theta,fill=simulation,color=simulation)) +
#geom_sina(size=0.05) +
geom_split_violin(lwd=2) +
labs(y=expression(theta[W]), color="Simulation",fill="Simulation") +
facet_grid(N~T, labeller = label_both_parsed_recode(variable_names),scales="free") +
scale_color_manual(values=c("grey56", "grey0"),labels=c("coalescent","forward")) +
scale_fill_manual(values=c("grey66","grey6"),labels=c("coalescent","forward")) +
theme_classic() +
theme(text=element_text(size=65),axis.text=element_text(size=30),
axis.text.x=element_text(angle=45,margin=margin(t=40)),
axis.title.x=element_text(face = "italic"),
axis.title.y=element_text(face = "italic"),
panel.border = element_rect(linetype = "dashed", fill = NA),
strip.text = element_text(face = "italic"),
legend.key.size = unit(2.5, 'lines'),
legend.text=element_text(size=40))
png("theta-by-n-by-T100-1000.png",height=2400,width=2400)
bp_100
dev.off()
bp_100<-ggplot(theta_data_factors[which(theta_data_factors$T==100 | theta_data_factors$T==1000),],
aes(x=n,y=theta,fill=simulation,color=simulation)) +
#geom_sina(size=0.05) +
geom_split_violin(lwd=2) +
labs(y=expression(theta[W]), color="Simulation",fill="Simulation") +
facet_grid(N~T, labeller = label_both_parsed_recode(variable_names),scales="free") +
scale_color_manual(values=c("grey56", "grey0"),labels=c("coalescent","forward")) +
scale_fill_manual(values=c("grey66","grey6"),labels=c("coalescent","forward")) +
theme_classic() +
theme(text=element_text(size=65),axis.text=element_text(size=30),
axis.text.x=element_text(angle=45,margin=margin(t=40)),
axis.title.x=element_text(face = "italic"),
axis.title.y=element_text(face = "italic"),
panel.border = element_rect(linetype = "dashed", fill = NA),
strip.text = element_text(face = "italic"),
legend.key.size = unit(2.5, 'lines'),
legend.text=element_text(size=40),
legend.position="bottom")
png("theta-by-n-by-T100-1000.png",height=2400,width=2400)
bp_100
dev.off()
bp_100<-ggplot(theta_data_factors[which(theta_data_factors$T==100 | theta_data_factors$T==1000),],
aes(x=n,y=theta,fill=simulation,color=simulation)) +
#geom_sina(size=0.05) +
geom_split_violin(lwd=2) +
labs(y=expression(theta[W]), color="Simulation",fill="Simulation") +
facet_grid(N~T, labeller = label_both_parsed_recode(variable_names),scales="free") +
scale_color_manual(values=c("grey56", "grey0"),labels=c("coalescent","forward")) +
scale_fill_manual(values=c("grey66","grey6"),labels=c("coalescent","forward")) +
theme_classic() +
theme(text=element_text(size=65),axis.text=element_text(size=30),
axis.text.x=element_text(angle=45,margin=margin(t=40)),
axis.title.x=element_text(face = "italic"),
axis.title.y=element_text(face = "italic"),
panel.border = element_rect(linetype = "dashed", fill = NA),
strip.text = element_text(face = "italic"),
#legend.key.size = unit(2.5, 'lines'),
legend.text=element_text(size=40),
legend.position="bottom")
png("theta-by-n-by-T100-1000.png",height=2400,width=2400)
bp_100
dev.off()
bp_100<-ggplot(theta_data_factors[which(theta_data_factors$T==100 | theta_data_factors$T==1000),],
aes(x=n,y=theta,fill=simulation,color=simulation)) +
#geom_sina(size=0.05) +
geom_split_violin(lwd=2) +
labs(y=expression(theta[W]), color="Simulation",fill="Simulation") +
facet_grid(N~T, labeller = label_both_parsed_recode(variable_names),scales="free") +
scale_color_manual(values=c("grey56", "grey0"),labels=c("coalescent","forward")) +
scale_fill_manual(values=c("grey66","grey6"),labels=c("coalescent","forward")) +
theme_classic() +
theme(text=element_text(size=65),axis.text=element_text(size=30),
axis.text.x=element_text(angle=45,margin=margin(t=40)),
axis.title.x=element_text(face = "italic"),
axis.title.y=element_text(face = "italic"),
panel.border = element_rect(linetype = "dashed", fill = NA),
strip.text = element_text(face = "italic"),
legend.key.size = unit(2.5, 'lines'),
legend.text=element_text(size=40),
legend.position="bottom")
bp_1<-ggplot(theta_data_factors[which(theta_data_factors$T==1 | theta_data_factors$T==10),],
aes(x=n,y=theta,fill=simulation,color=simulation)) +
#geom_sina(size=0.05) +
geom_split_violin(lwd=2) +
labs(y=expression(theta[W]), color="Simulation",fill="Simulation") +
facet_grid(N~T, labeller = label_both_parsed_recode(variable_names),scales="free") +
scale_color_manual(values=c("grey56", "grey0"),labels=c("coalescent","forward")) +
scale_fill_manual(values=c("grey66","grey6"),labels=c("coalescent","forward")) +
theme_classic() +
theme(text=element_text(size=65),axis.text=element_text(size=30),
axis.text.x=element_text(angle=45,margin=margin(t=40)),
axis.title.x=element_text(face = "italic"),
axis.title.y=element_text(face = "italic"),
panel.border = element_rect(linetype = "dashed", fill = NA),
strip.text = element_text(face = "italic"),
legend.key.size = unit(2.5, 'lines'),
legend.text=element_text(size=40),
legend.position="bottom")
png("theta-by-n-by-T1-10.png",height=2400,width=2400)
bp_1
dev.off()
png("theta-by-n-by-T100-1000.png",height=2400,width=2400)
bp_100
dev.off()
png("theta-by-n-by-T1-10.png",height=3000,width=2400)
bp_1
dev.off()
png("theta-by-n-by-T100-1000.png",height=3000,width=2400)
bp_100
dev.off()
help(facet_grid)
bp_1<-ggplot(theta_data_factors[which(theta_data_factors$T==1 | theta_data_factors$T==10),],
aes(x=n,y=theta,fill=simulation,color=simulation)) +
#geom_sina(size=0.05) +
geom_split_violin(lwd=2) +
labs(y=expression(theta[W]), color="Simulation",fill="Simulation") +
facet_grid(N~T, labeller = label_both_parsed_recode(variable_names),scales="fixed") +
scale_color_manual(values=c("grey56", "grey0"),labels=c("coalescent","forward")) +
scale_fill_manual(values=c("grey66","grey6"),labels=c("coalescent","forward")) +
theme_classic() +
theme(text=element_text(size=65),axis.text=element_text(size=30),
axis.text.x=element_text(angle=45,margin=margin(t=40)),
axis.title.x=element_text(face = "italic"),
axis.title.y=element_text(face = "italic"),
panel.border = element_rect(linetype = "dashed", fill = NA),
strip.text = element_text(face = "italic"),
legend.key.size = unit(2.5, 'lines'),
legend.text=element_text(size=40),
legend.position="bottom")
png("theta-by-n-by-T1-10.png",height=3000,width=2400)
bp_1
dev.off()
time_iter<-0
new_nNe_diff_theta<-list()
for (time in times){
time_iter<-time_iter+1
new_nNe_diff<-melt(n_over_Ne_diff,id="n_over_Ne",na.rm=TRUE)
new_nNe_diff<-new_nNe_diff[,-2]
colnames(new_nNe_diff)<-c("n_over_Ne","perc_diff","T")
new_nNe_diff$Ne<-as.factor(c(rep(10,6),rep(20,6),rep(50,6),rep(100,6),rep(200,6),rep(500,6),rep(1000,6)))
new_nNe_diff_theta<-new_nNe_diff
}
new_nNe_diff_theta[which(new_nNe_diff_theta$T==2),3]<-10
new_nNe_diff_theta[which(new_nNe_diff_theta$T==3),3]<-100
new_nNe_diff_theta[which(new_nNe_diff_theta$T==4),3]<-1000
# new_nNe_cv_sfs<-melt(n_over_Ne_cv_sfs,id="n_over_Ne",na.rm=TRUE)
#     new_nNe_cv_sfs<-new_nNe_cv_sfs[,-2]
# new_nNe_cv_ms<-melt(n_over_Ne_cv_ms,id="n_over_Ne",na.rm=TRUE)
#     new_nNe_cv_ms<-new_nNe_cv_ms[,-2]
#     new_nNe_cv<-rbind(new_nNe_cv_ms,new_nNe_cv_sfs)
#     new_nNe_cv<-cbind(new_nNe_cv,c(rep("ms",length(new_nNe_cv_ms[,1])),rep("sfs",length(new_nNe_cv_sfs[,1]))))
#     colnames(new_nNe_cv)<-c("n_over_Ne","CV","simulation")
library(magrittr)
library(dplyr)
library(RColorBrewer)
mycolours<-brewer.pal(n = 7, name = "Dark2")
#mycolours<-c("highlight" = "red", "normal" = "grey50")
point_sizes<-log(as.numeric(as.character(new_nNe_diff_theta$Ne)))
p1<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne)) +
geom_point(aes(color=Ne,size=Ne)) +
geom_hline(yintercept=0, linetype="dashed") +
#scale_fill_gradient(low="orange", high="blue") +
#scale_color_gradient(low="orange",high="blue") +
labs(x=expression(n/N[e]),y="Percent difference in theta") +
theme(text=element_text(size=30),axis.text=element_text(size=18),axis.text.x = element_text(angle = 45, margin=margin(t=20))) +
facet_wrap(~T, ncol=4,labeller="label_both")
p2<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=7) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name="Ne") +
geom_hline(yintercept=0, linetype="dashed") +
#scale_fill_gradient(low="orange", high="blue") +
#scale_color_gradient(low="orange",high="blue") +
labs(x=expression(n/N[e]),y="Percent difference in theta") +
theme(panel.background = NULL,text=element_text(size=30),axis.text=element_text(size=18),axis.text.x = element_text(angle = 45, margin=margin(t=20))) +
#scale_fill_manual("Ne", values = mycolours) +
scale_fill_manual(values = mycolours) +
scale_color_manual(values=mycolours) +
facet_wrap(~T, ncol=4,labeller="label_both")
q1<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne)) +
geom_point(aes(color=Ne,size=Ne)) +
geom_hline(yintercept=0, linetype="dashed") +
#scale_fill_gradient(low="orange", high="blue") +
#scale_color_gradient(low="orange",high="blue") +
labs(x=expression(n/N[e]),y="Percent difference in theta") +
theme(text=element_text(size=30),axis.text=element_text(size=18),axis.text.x = element_text(angle = 45, margin=margin(t=20))) +
#scale_fill_manual("Ne", values = mycolours) +
scale_fill_manual(values = mycolours) +
scale_color_manual(values=mycolours) +
facet_wrap(~T,scales="free",ncol=4,labeller="label_both")
q2<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=7) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name="Ne") +
geom_hline(yintercept=0, linetype="dashed") +
#scale_fill_gradient(low="orange", high="blue") +
#scale_color_gradient(low="orange",high="blue") +
labs(x=expression(n/N[e]),y="Percent difference in theta") +
scale_fill_manual(values = mycolours) +
scale_color_manual(values=mycolours) +
theme(text=element_text(size=30),axis.text=element_text(size=18),axis.text.x = element_text(angle = 45, margin=margin(t=20))) +
#scale_fill_manual("Ne", values = mycolours) +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
p1
q2
time_iter<-0
for (time in times){
time_iter<-time_iter+1
png(paste("T",time,"-n_over_Ne_theta-msvssfs.png",sep=""))
nam<-paste("p",time_iter,sep="")
p<-ggplot(data=new_nNe_diff_theta,aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne)) +
geom_point(size=3) +
geom_hline(yintercept=0, linetype="dashed") +
#scale_fill_gradient(low="orange", high="blue") +
#scale_color_gradient(low="orange",high="blue") +
labs(x="n/Ne",y="Percent difference in theta") +
theme(text=element_text(size=45),axis.text=element_text(size=25),axis.text.x = element_text(angle = 45, margin=margin(t=20))) +
scale_color_manual("Ne", values = mycolours) +
ggtitle(paste("T = ",time,sep=""))
#                    facet_grid(~T, scales="free", labeller="label_both")
assign(nam,p)
print(p)
dev.off()
}
multiplot(p1,p2,p3,p4,cols=4)
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=6, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 45, margin=margin(t=20)),
legend.title.align=0.2) +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
n_Ne_bottleneck
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 45, margin=margin(t=20), size=20),
legend.title.align=0.2) +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
n_Ne_bottleneck
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 45, margin=margin(t=20), size=10),
legend.title.align=0.2) +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
n_Ne_bottleneck
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 75, margin=margin(t=20), size=10),
legend.title.align=0.2) +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
n_Ne_bottleneck
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 65, margin=margin(t=20), size=10),
legend.title.align=0.2) +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
n_Ne_bottleneck
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 65, margin=margin(t=20), size=10),
legend.title.align=0.2,
legend.position="bottom") +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
png("n-Ne-shapes-nobottleneck.png",height=2400,width=10400,res=300)
n_Ne_bottleneck
dev.off()
png("n-Ne-shapes-bottleneck.png",height=2400,width=10400,res=300)
n_Ne_bottleneck
dev.off()
dev.off()
png("n-Ne-shapes-bottleneck.png",height=2400,width=10400,res=300)
n_Ne_bottleneck
dev.off()
png("n-Ne-shapes-bottleneck.png",height=2400,width=9000,res=300)
n_Ne_bottleneck
dev.off()
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 65, margin=margin(t=20), size=30),
legend.title.align=0.2,
legend.position="bottom") +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
png("n-Ne-shapes-bottleneck.png",height=2400,width=9000,res=300)
n_Ne_bottleneck
dev.off()
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 65, margin=margin(t=20), size=20),
legend.title.align=0.2,
legend.position="bottom") +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
png("n-Ne-shapes-bottleneck.png",height=2400,width=9000,res=300)
n_Ne_bottleneck
dev.off()
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 90, margin=margin(t=20), size=20),
legend.title.align=0.2,
legend.position="bottom",
legend.direction="horizontal") +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
png("n-Ne-shapes-bottleneck.png",height=2400,width=9000,res=300)
n_Ne_bottleneck
dev.off()
help(legend.direction)
help(theme)
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 90, margin=margin(t=20), size=20),
legend.title.align=0.2,
legend.position="bottom",
legend.direction="horizontal") +
guides(colour = guide_legend(nrow = 1)) +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
png("n-Ne-shapes-bottleneck.png",height=2400,width=9000,res=300)
n_Ne_bottleneck
dev.off()
help(guides)
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 90, margin=margin(t=20), size=20),
legend.title.align=0.2,
legend.position="bottom",
legend.direction="horizontal") +
guides(color = guide_legend(nrow = 1), shape= guide_legend(nrow = 1) ) +
facet_wrap(~T, ncol=4,scales="free",labeller="label_both")
png("n-Ne-shapes-bottleneck.png",height=2400,width=9000,res=300)
n_Ne_bottleneck
dev.off()
png("n-Ne-shapes-bottleneck.png",height=2400,width=8000,res=300)
n_Ne_bottleneck
dev.off()
png("n-Ne-shapes-bottleneck.png",height=2400,width=7000,res=300)
n_Ne_bottleneck
dev.off()
n_Ne_bottleneck<-ggplot(data=new_nNe_diff_theta %>% arrange(desc(Ne)),aes(x=as.factor(n_over_Ne),y=perc_diff,fill=Ne,shape=Ne)) +
geom_point(aes(color=Ne),size=5, alpha=.9) +
scale_shape_manual(values=rev(c(3,4,16,17,18,15,25)),name=expression(italic(N[e]))) +
geom_hline(yintercept=0, linetype="dashed") +
labs(x=expression(frac(italic(n),italic(N[e]))),y=expression(Percent~difference~"in"~theta[W])) +
scale_color_grey(start=.6, end=0,name=expression(italic(N[e]))) +
scale_fill_grey(start=.8, end=.2,name=expression(italic(N[e]))) +
theme(panel.background = NULL,text=element_text(size=30),
axis.text=element_text(size=18),
axis.text.x = element_text(angle = 90, margin=margin(t=20), size=20),
legend.title.align=0.2,
legend.position="bottom",
legend.direction="horizontal") +
guides(color = guide_legend(nrow = 1), shape= guide_legend(nrow = 1) ) +
facet_wrap(~T, ncol=2,scales="free",labeller="label_both")
png("n-Ne-shapes-bottleneck.png",height=2400,width=7000,res=300)
n_Ne_bottleneck
dev.off()
png("n-Ne-shapes-bottleneck.png",height=2400,width=3500,res=300)
n_Ne_bottleneck
dev.off()
png("n-Ne-shapes-bottleneck.png",height=600,width=3500,res=300)
n_Ne_bottleneck
dev.off()
png("n-Ne-shapes-bottleneck.png",height=6000,width=3500,res=300)
n_Ne_bottleneck
dev.off()
png("n-Ne-shapes-bottleneck.png",height=4000,width=3500,res=300)
n_Ne_bottleneck
dev.off()
